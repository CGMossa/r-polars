---
title: "minipolars_teaser"
author: "SÃ¸ren Welling"
date: "7/18/2022"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
library(minipolars)
library(magrittr)
knitr::opts_chunk$set(echo = TRUE)
```

## minipolar

This document demonstrates the feasibility wrapping the excelling data table rust library polars <http://pola.rs> in an R package. Spoiler is quite possible.

Besides polars, this wrapping relies on extendr <https://github.com/extendr> which are the R equivalents of pyo3 and maturin.

```{r}
#loading polars as regular r package would all functions exposed would give a huge name space collision with sum(), col() from base R.
library(minipolars) #corrosponds import any public function, similar to `use minipolars::*` 


#instead I suggest to use an isolated namespace 
minipolars::import_polars_as_()



#the biggest change is to use $-operator for method call instead of .
pl::col("hello")$sum()$over(c("world","from"))$alias("polars")

```

## Now for the rest implemented so far


```{r mix_values}
#creating polar_frame from mixed columns
values = list (
  newname = pl::series(c(1,2,3,4,5),name = "b"), #overwrite name b with newname
  pl::series((1:5) * 5,"a"),
  pl::series(letters[1:5],"b"),
  c(5,4,3,2,1), #unnamed vector
  named_vector = c(15,14,13,12,11) ,#named provide
  c(5,4,3,2,0)
)

pl::pf(values)

```


```{r iris}
#creating polar_frame  iris, perform selection and convert back to data.frame
pf = pl::pf(iris)


#make selection with expressions or strings, convert back to data.frame
pf$select(
  pl::col("Sepal.Width")$sum()$over("Species")$alias("sw_sum_over_species"),
  pl::col("Sepal.Length")$sum()$over("Species")$alias("sl_sum_over_species"),
  "Petal.Width"
)$as_data_frame() %>% head

```


```{r datatypes}
#creating polar_frame  iris, perform selection and convert back to data.frame
pl::datatype("Float64")
pl::datatype("integer")


```
